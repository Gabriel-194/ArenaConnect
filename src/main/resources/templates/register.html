<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ArenaConnect - Cadastro</title>
    <link rel="stylesheet" th:href="@{/styles/base.css}">
    <link rel="stylesheet" th:href="@{/styles/components.css}">
    <link rel="stylesheet" th:href="@{/styles/register.css}">
    <link rel="stylesheet" th:href="@{/styles/layout.css}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Racing+Sans+One&display=swap" rel="stylesheet">
</head>
<body>
<div class="login-container">
    <div class="login-card">
        <div class="login-header">
            <div class="logo">
                <img th:src="@{/assets/3-removebg-preview.png}" alt="logo" style="width: 80px">
                <h1 style="font-family: 'Racing Sans One', cursive;">Arena Connect</h1>
            </div>
            <p class="subtitle">Escolha o tipo de cadastro</p>
        </div>

        <div class="register-type-container">
            <button type="button" class="register-type-btn" id="btn-register-cliente">
                <div class="register-type-icon">
                    <img th:src="@{/assets/user-svgrepo-com.svg}" alt="client logo" style="width: 50px;">
                </div>
                <h3>Sou Cliente</h3>
                <p>Quero reservar quadras para jogar</p>
            </button>

            <button type="button" class="register-type-btn" id="btn-register-admin">
                <div class="register-type-icon">
                    <img th:src="@{/assets/stadium-svgrepo-com.svg}" alt="arena logo" style="width: 50px;">
                </div>
                <h3>Sou Dono de Arena</h3>
                <p>Quero gerenciar meu complexo</p>
            </button>
        </div>

        <div class="form-footer">
            <span class="footer-text">Já tem uma conta?</span>
            <a th:href="@{/login}" class="link-accent">Fazer login</a>
        </div>
    </div>
</div>

<div id="modal-cliente" class="modal">
    <div class="modal-content modal-wide">
        <div class="modal-header">
            <h2>Cadastro de Cliente</h2>
            <button class="modal-close" type="button" id="close-cliente">&times;</button>
        </div>

        <form th:action="@{register}" th:object="${userDTO}" method="post" class="form form-grid">
            <div class="form-group col-span-2">
                <label >Nome Completo *</label>
                <input type="text" th:field="*{nome}" placeholder="Seu nome completo" required>
            </div>

            <div class="form-group">
                <label >CPF *</label>
                <input type="text" th:field="*{cpf}" placeholder="000.000.000-00" required maxlength="14" oninput="mascaraCPF(this)" >
                <span th:if="${#fields.hasErrors('cpf')}"
                      th:errors="*{cpf}"
                      class="text-danger"></span>
            </div>

            <div class="form-group">
                <label >Telefone</label>
                <input type="tel" th:field="*{telefone}" placeholder="(00) 00000-0000" maxlength="15" oninput="mascaraTelefone(this)">
            </div>

            <div class="form-group col-span-2">
                <label >E-mail *</label>
                <input type="email" th:field="*{email}" placeholder="seu@email.com" required>
                <span th:if="${#fields.hasErrors('email')}"
                      th:errors="*{email}"
                      class="text-danger"></span>
            </div>

            <div class="form-group">
                <label>Senha *</label>
                <input type="password" th:field="*{senha}" placeholder="••••••••" required minlength="6">
                <span th:if="${#fields.hasErrors('senha')}"
                      th:errors="*{senha}"
                      class="text-danger"></span>
            </div>

            <div class="form-group">
                <label >Confirmar Senha *</label>
                <input type="password" name="confirmPassword" placeholder="••••••••" required minlength="6">

            </div>

            <input type="hidden" name="role" value="CLIENTE">

            <div class="modal-actions col-span-2">
                <button type="button" class="btn-secondary" id="cancel-cliente">Cancelar</button>
                <button type="submit" class="btn-primary">Criar Conta</button>
            </div>
        </form>
    </div>
</div>

<div id="modal-admin" class="modal">
    <div class="modal-content modal-wide">
        <div class="modal-header">
            <h2>Cadastro de Parceiro</h2>
            <button class="modal-close" type="button" id="close-admin">&times;</button>
        </div>

        <form th:action="@{register-partner}" th:object="${parceiroDTO}" class="form form-grid" method="post">

            <h3 class="col-span-2 section-title">Seus Dados Pessoais</h3>

            <div class="form-group col-span-2">
                <label >Nome Completo *</label>
                <input type="text" th:field="*{nomeUser}" placeholder="Nome do proprietário" required>
            </div>

            <div class="form-group">
                <label >CPF *</label>
                <input type="text" th:field="*{cpfUser}" placeholder="000.000.000-00" required maxlength="14">
            </div>

            <div class="form-group">
                <label >Celular / WhatsApp</label>
                <input type="tel" th:field="*{telefoneUser}" placeholder="(00) 00000-0000" maxlength="15">
            </div>

            <div class="form-group col-span-2">
                <label >E-mail de Login *</label>
                <input type="email" th:field="*{emailAdmin}" placeholder="seu@email.com" required>
            </div>

            <div class="form-group">
                <label >Senha *</label>
                <input type="password" th:field="*{senhaAdmin}" placeholder="••••••••" required minlength="6">
            </div>

            <div class="form-group">
                <label >Confirmar Senha *</label>
                <input type="password" placeholder="••••••••" required minlength="6">
            </div>

            <hr class="col-span-2 separator">

            <h3 class="col-span-2 section-title"> Dados do seu Complexo Esportivo</h3>

            <div class="form-group col-span-2">
                <label >Nome da Arena *</label>
                <input type="text" th:field="*{nomeArena}" placeholder="Ex: Arena Gol de Placa" required>
            </div>

            <div class="form-group">
                <label >CNPJ da Empresa *</label>
                <input type="text" th:field="*{cnpjArena}" placeholder="00.000.000/0000-00" required maxlength="18">
            </div>

            <div class="form-group">
                <label >CEP *</label>
                <input type="text" th:field="*{cepArena}" placeholder="00000-000" required maxlength="9">
                <small id="cep-status" style="color: white; display: none;">Buscando...</small>
            </div>

            <div class="form-group col-span-2">
                <label >Endereço</label>
                <input type="text" th:field="*{enderecoArena}" placeholder="Rua, Número, Bairro" readonly class="input-readonly">
            </div>

            <div class="form-group">
                <label >Cidade</label>
                <input type="text" th:field="*{cidadeArena}" placeholder="Cidade" readonly class="input-readonly">
            </div>

            <div class="form-group">
                <label >Estado</label>
                <input type="text" th:field="*{estadoArena}" placeholder="UF" readonly class="input-readonly" maxlength="2">
            </div>

            <div class="modal-actions col-span-2" style="margin-top: 1rem;">
                <button type="button" class="btn-secondary" id="cancel-admin">Cancelar</button>
                <button type="submit" class="btn-primary" id="btn-submit-partner">Finalizar Cadastro</button>
            </div>
        </form>
    </div>
</div>
<script >
    function mascaraCPF(input) {
        let value = input.value.replace(/\D/g, '');

        value = value.replace(/(\d{3})(\d)/, '$1.$2');
        value = value.replace(/(\d{3})(\d)/, '$1.$2');
        value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');

        input.value = value;
    }

    function mascaraTelefone(input) {
        let value = input.value.replace(/\D/g, '');

        if (value.length <= 10) {
            value = value.replace(/(\d{2})(\d)/, '($1) $2');
            value = value.replace(/(\d{4})(\d)/, '$1-$2');
        } else {
            value = value.replace(/(\d{2})(\d)/, '($1) $2');
            value = value.replace(/(\d{5})(\d)/, '$1-$2');
        }

        input.value = value;
    }

    const modalCliente = document.getElementById("modal-cliente")
    const btnCliente = document.getElementById("btn-register-cliente")
    const closeClienteBtn = document.getElementById("close-cliente")
    const cancelClienteBtn = document.getElementById("cancel-cliente")

    if (btnCliente) {
        btnCliente.addEventListener("click", () => {
            modalCliente.classList.add("active")
        })
    }

    function fecharModalCliente() {
        if (modalCliente) modalCliente.classList.remove("active")
    }

    if (closeClienteBtn) closeClienteBtn.addEventListener("click", fecharModalCliente)
    if (cancelClienteBtn) cancelClienteBtn.addEventListener("click", fecharModalCliente)

    const modalAdmin = document.getElementById("modal-admin")
    const btnAdmin = document.getElementById("btn-register-admin")
    const closeAdminBtn = document.getElementById("close-admin")
    const cancelAdminBtn = document.getElementById("cancel-admin")

    if (btnAdmin) {
        btnAdmin.addEventListener("click", () => {
            modalAdmin.classList.add("active")
        })
    }

    function fecharModalAdmin() {
        if (modalAdmin) modalAdmin.classList.remove("active")
    }

    if (closeAdminBtn) closeAdminBtn.addEventListener("click", fecharModalAdmin)
    if (cancelAdminBtn) cancelAdminBtn.addEventListener("click", fecharModalAdmin)

</script>
<script th:inline="javascript">
    const tipoCadastro = /*[[${tipoCadastro}]]*/ null;

    if (tipoCadastro === 'cliente') {
        document.getElementById("modal-cliente")?.classList.add("active");
    }

    if (tipoCadastro === 'parceiro') {
        document.getElementById("modal-admin")?.classList.add("active");
    }

</script>

</body>
</html>